<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Scraping the Kenya Gazette</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="clipboard.min.js"></script>
<script src="quarto.js"></script>
<script src="popper.min.js"></script>
<script src="tippy.umd.min.js"></script>
<script src="anchor.min.js"></script>
<link href="tippy.css" rel="stylesheet">
<link href="quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="bootstrap.min.js"></script>
<link href="bootstrap-icons.css" rel="stylesheet">
<link href="bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Scraping the Kenya Gazette</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="creating-a-database-with-a-list-of-the-issue-of-new-land-title-deeds-in-kenya." class="level1">
<h1>Creating a database with a list of the issue of new land title deeds in Kenya.</h1>
<p>This is a project scraping HTML pages of weekly Kenya Gazette notices starting from 2010 in order to retrieve and categorise land-related notices. The result is a database with more than 200,000 rows of land-related notice entries.</p>
<section id="getting-the-data" class="level3">
<h3 class="anchored" data-anchor-id="getting-the-data">Getting the Data</h3>
<ul>
<li><a href="http://kenyalaw.org/kenya_gazette/gazette">Weekly Kenya Gazette notices</a></li>
<li><a href="http://www.statoids.com/yke.html">Districts, areas and population</a></li>
<li><a href="https://www.igismap.com/kenya-shapefile-download-boundary-line-administrative-state-and-polygon/">Shapefile of Kenyan provinces</a></li>
</ul>
</section>
<section id="the-kenya-gazette" class="level2">
<h2 class="anchored" data-anchor-id="the-kenya-gazette">The Kenya Gazette</h2>
</section>
<section id="this-is-what-the-home-page-of-the-kenya-gazette-looks-like" class="level2">
<h2 class="anchored" data-anchor-id="this-is-what-the-home-page-of-the-kenya-gazette-looks-like">This is what the home page of the Kenya Gazette looks like</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="screenshot_of_home_page.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Home Page</figcaption>
</figure>
</div>
</section>
<section id="this-is-what-the-landing-page-for-one-year-of-gazette-notices-looks-like" class="level2">
<h2 class="anchored" data-anchor-id="this-is-what-the-landing-page-for-one-year-of-gazette-notices-looks-like">This is what the landing page for one year of gazette notices looks like</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="screenshot_of_2022_page.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Landing Page for 2022</figcaption>
</figure>
</div>
</section>
</section>

</section>
</section>
<section id="how-i-got-the-urls-for-each-year" class="level1">
<h1>How I got the urls for each year</h1>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to get each url for each year containing a list of the year's gazette notices</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>year_link_dict_list<span class="op">=</span>[]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> years:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    year_link_dict<span class="op">=</span>{}</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    url_year<span class="op">=</span>url_year_base<span class="op">+</span><span class="bu">str</span>(year)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(url_year)</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    year_link_dict[<span class="st">'year'</span>]<span class="op">=</span>year</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    year_link_dict[<span class="st">'url_year'</span>]<span class="op">=</span>url_year</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    year_link_dict_list.append(year_link_dict)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>url_year_links <span class="op">=</span> [x[<span class="st">'url_year'</span>] <span class="cf">for</span> x <span class="kw">in</span> year_link_dict_list]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To see a list of dictionaries each with a year and its url</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>year_link_dict_list[<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[{'year': 2010,
  'url_year': 'http://kenyalaw.org/kenya_gazette/gazette/year/2010'},
 {'year': 2011,
  'url_year': 'http://kenyalaw.org/kenya_gazette/gazette/year/2011'}]</code></pre>
</div>
</div>
</section>
<section id="how-i-got-the-html-content-on-each-years-page-for-all-gazette-notices-within-it." class="level1">
<h1>How I got the HTML content on each yearâ€™s page for all gazette notices within it.</h1>
<section id="here-as-a-list-of-dictionaries-i-get-the-following-information" class="level3">
<h3 class="anchored" data-anchor-id="here-as-a-list-of-dictionaries-i-get-the-following-information">Here, as a list of dictionaries, I get the following information:</h3>
<ul>
<li>year</li>
<li>url for the year</li>
<li>url for each gazette notice within the year. I then exploded this so that each html for a weekly gazette notice gets its own row</li>
</ul>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year_link_dict <span class="kw">in</span> year_link_dict_list:</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     print("$$$$$$$$$$$$")</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    url_year_link<span class="op">=</span>year_link_dict[<span class="st">'url_year'</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(url_year_link)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    year_raw_html <span class="op">=</span> requests.get(url_year_link).content</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(type(year_raw_html))</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#assign year_urls_soup_doc as the doc holding parsed html </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#learn type of year_urls_soup_doc</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    year_urls_soup_doc <span class="op">=</span> BeautifulSoup(year_raw_html, <span class="st">"html.parser"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(type(year_urls_soup_doc))</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     print("________")</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#These are the links on the page for all gazette notices</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    links_within_year<span class="op">=</span>year_urls_soup_doc.select(<span class="st">'#content'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Both weekly and special gazette notices sections</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    sections_within_year <span class="op">=</span> <span class="bu">str</span>(links_within_year).split(<span class="st">'&lt;p&gt;'</span>) </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#To get weekly issues only use sections_within_year[1]</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Then split it by tr to get each entry of a gazette notice</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    sections_within_year[<span class="dv">1</span>].split(<span class="st">'&lt;tr&gt;'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    weekly_section<span class="op">=</span>sections_within_year[<span class="dv">1</span>]</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    weekly_section_entries<span class="op">=</span>weekly_section.split(<span class="st">'&lt;tr&gt;'</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    link_href_list<span class="op">=</span>[]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> link_within_section <span class="kw">in</span> weekly_section_entries:</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>            link_href<span class="op">=</span>link_within_section.split(<span class="st">'&lt;td&gt;'</span>)[<span class="dv">2</span>].split(<span class="st">'"'</span>)[<span class="dv">1</span>]</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#             print(link_href)</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#             print("______")</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>            link_href_list.append(link_href)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>            year_link_dict[<span class="st">'gazette_links'</span>]<span class="op">=</span>link_href_list</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(year_link_dict)</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(year_link_dict_list[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'year': 2010, 'url_year': 'http://kenyalaw.org/kenya_gazette/gazette/year/2010', 'gazette_links': ['http://kenyalaw.org/kenya_gazette/gazette/volume/Mjg0/Vol. CXII - No. 135/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/Mjc0/Vol. CXII - No. 133/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/Mjcy/Vol. CXII - No. 131/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/Mjcw/Vol. CXII - No. 128/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjY5/Vol. CXII - No. 125/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjY4/Vol. CXII - No. 123/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjY3/Vol. CXII - No. 120/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjYx/Vol. CXII - No. 114/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjU1/Vol. CXII - No. 108/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjU2/Vol. CXII - No. 109/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjUy/Vol. CXII - No. 105/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjQ4/Vol. CXII - No. 101/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjQ1/Vol. CXII - No. 99/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjQx/Vol. CXII - No. 95/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjM4/Vol. CXII - No. 93/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjM2/Vol. CXII - No. 91/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjM1/Vol. CXII - No. 90/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjMz/Vol. CXII - No. 88/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjMx/Vol. CXII - No. 85/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjI5/Vol. CXII - No. 83/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjI1/Vol. CXII - No. 79/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjIz/Vol. CXII - No. 77/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjE5/Vol. CXII - No. 73/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTk3/Vol. CXII - No. 70/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTk4/Vol. CXII - No. 69/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTk5/Vol. CXII - No. 67/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjAx/Vol. CXII - No. 65/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjE2/Vol. CXII - No. 62/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjA1/Vol. CXII - No. 61/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjA3/Vol. CXII - No. 58/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjA4/Vol. CXII - No. 56/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjA5/Vol. CXII - No. 55/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjEx/Vol. CXII - No. 53/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTky/Vol. CXII - No. 49/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTg5/Vol. CXII - No. 46/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTg3/Vol. CXII - No. 44/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjE1/Vol. CXII - No. 40/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MjE0/Vol. CXII - No. 38/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/Mjc3/Vol. CXII - No. 37/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTc4/Vol. CXII - No. 34/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTcz/Vol. CXII - No. 30/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTcx/Vol. CXII - No. 28/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTY4/Vol. CXII - No. 24/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTY2/Vol. CXII - No. 22/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTY1/Vol. CXII - No. 21/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTU5/Vol. CXII - No. 18/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTU3/Vol. CXII - No. 16/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTU1/Vol. CXII - No. 15/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTUz/Vol. CXII - No. 13/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTUy/Vol. CXII - No. 12/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTUx/Vol. CXII - No. 11/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTUw/Vol. CXII - No. 10/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTQ4/Vol. CXII - No. 8/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTQ1/Vol. CXII - No. 5/', 'http://kenyalaw.org/kenya_gazette/gazette/volume/MTQz/Vol. CXII - No. 3/']}</code></pre>
</div>
</div>
</section>
</section>

<section id="this-is-what-the-one-section-of-land-related-notices-in-the-weekly-kenya-gazette-looks-like" class="level2">
<h2 class="anchored" data-anchor-id="this-is-what-the-one-section-of-land-related-notices-in-the-weekly-kenya-gazette-looks-like">This is what the one section of land-related notices in the Weekly Kenya Gazette looks like</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
  
<p><img src="one_section_of_land_notices_in_weekly_gazette.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">One section of land-related notices</figcaption>
</figure>
</div>
</section>

</section>
<section id="how-i-created-a-function-that-scrapes-a-url-for-a-gazette-notice-to-extract-the-following-information" class="level1">
<h1>How I created a function that scrapes a url for a gazette notice to extract the following information:</h1>
<ul>
<li>volume number: volume_num</li>
<li>volume date: volume_date</li>
<li>volume url: volume_url</li>
<li>title of noticeâ€™s number: notice_num_title</li>
<li>title of noticeâ€™s act: notice_act_title</li>
<li>noticeâ€™s capital and section: notice_num_year</li>
<li>noticeâ€™s subtitle: notice_sub_title</li>
<li>noticeâ€™s full body of info: notice_body</li>
<li>specific noticeâ€™s date: notice_date</li>
<li>name of noticeâ€™s registrar: notice_registrar_name</li>
<li>number and location of notice: notice_num_loc</li>
<li>noticeâ€™s location: notice_loc</li>
</ul>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scrape_url(my_url):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>: </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        raw_html <span class="op">=</span> requests.get(my_url).content</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">#assign soup_doc as the doc holding parsed html </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">#learn type of soup_doc</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        soup_doc <span class="op">=</span> BeautifulSoup(raw_html, <span class="st">"html.parser"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Finding volume number to keep track of what data is from what source in larger csv</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># creating a list of all divs with id starting with GAZETTE </span><span class="al">NOTICE</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        list_all_divs<span class="op">=</span> [elem.parent.parent <span class="cf">for</span> elem <span class="kw">in</span> soup_doc.find_all(<span class="st">"em"</span>, text<span class="op">=</span>re.<span class="bu">compile</span>(<span class="st">"(Land Registrar|Registrar of Land|Registrar of Titles)"</span>, re.IGNORECASE))]</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">#The parent of p is a div</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print("Found", len(list_all_divs), "potentials")</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">#create function for making a dictionary out of each entry within the list of all divs</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> class_to_dictionary(list_of_items):</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>            <span class="co">#initialise keys of dictionary</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>            dict_titles<span class="op">=</span>[<span class="st">'volume_num'</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'volume_date'</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'volume_url'</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_num_title'</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_act_title'</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_num_year'</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_sub_title'</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_body'</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_date'</span>,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_registrar_name'</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_num_loc'</span>,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'notice_loc'</span>]</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>            <span class="co">#initialise empty list which will contain all new notice entries</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>            all_new_notice_entries<span class="op">=</span>[]</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>            <span class="co">#For one entry within the list of items which is a variable you will pass in the function</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">#list_of_items will usually be the large capsules containing gazette entries</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>            <span class="co">#mostly for the ones I have seen there are two such capsules among these that have land registration act entries</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> one_item <span class="kw">in</span> list_of_items:</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>                <span class="co">#if the words LAND REGISTRATION ACT or Land Registrar appear in the text</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"LAND REGISTRATION ACT"</span> <span class="kw">in</span> one_item.text <span class="kw">or</span> <span class="st">"Land Registrar"</span> <span class="kw">in</span> one_item.text:</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#Then split one_item at the &lt;hr/&gt; point</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>                    entry_deets <span class="op">=</span> <span class="bu">str</span>(one_item).split(<span class="st">'&lt;hr/&gt;'</span>) </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#now entry_deets is a list of notices within the capsule</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> entry_deet <span class="kw">in</span> entry_deets:</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#one entry_deet is a notice within the capsule</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#initialise a list which I plan to zip to dict_titles to make a dictionary</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list<span class="op">=</span>[]</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#since I changed to string to split on hr</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#I need to return the content to beautiful soup classes</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>                        entry_deet_soup <span class="op">=</span> BeautifulSoup(entry_deet, <span class="st">"html.parser"</span>)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#now make a list of all p's within the gazette notice</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>                        entry_deet_paragraphs <span class="op">=</span> entry_deet_soup.find_all(<span class="st">'p'</span>)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#When converting to text I kept getting Xa0</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Normalize unicode data like this</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">#               # normalize("NFKD", x.text)</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># https://stackoverflow.com/questions/10993612/how-to-remove-xa0-from-string-in-python</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>                        entry_deet_paragraphs <span class="op">=</span> [normalize(<span class="st">"NFKD"</span>, x.text) <span class="cf">for</span> x <span class="kw">in</span> entry_deet_paragraphs <span class="cf">if</span> x.text.strip()<span class="op">!=</span><span class="st">''</span>]</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">len</span>(entry_deet_paragraphs) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">continue</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#Introducing number, date and url</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#Then the rest comes from </span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>                        volume_num<span class="op">=</span>soup_doc.select(<span class="st">".gazette-content #content div"</span>)[<span class="dv">2</span>].text</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>                        volume_date<span class="op">=</span>soup_doc.select(<span class="st">".gazette-content #content div"</span>)[<span class="dv">3</span>].text</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>                        volume_url<span class="op">=</span>my_url</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>                        notice_num_title<span class="op">=</span>entry_deet_paragraphs[<span class="dv">0</span>]</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>                        notice_act_title<span class="op">=</span>entry_deet_paragraphs[<span class="dv">1</span>]</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>                        notice_num_year<span class="op">=</span>entry_deet_paragraphs[<span class="dv">2</span>]</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>                        notice_sub_title<span class="op">=</span>entry_deet_paragraphs[<span class="dv">3</span>]</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>                        notice_body<span class="op">=</span>entry_deet_paragraphs[<span class="dv">4</span>]</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>                        notice_date<span class="op">=</span>entry_deet_paragraphs[<span class="dv">5</span>]</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>                        notice_registrar_name<span class="op">=</span>entry_deet_paragraphs[<span class="dv">6</span>]</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>                        notice_num_loc<span class="op">=</span>entry_deet_paragraphs[<span class="dv">7</span>]</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">try</span>:</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>                            notice_loc<span class="op">=</span>(entry_deet_soup.find_all(<span class="st">'p'</span>)[<span class="op">-</span><span class="dv">1</span>]).text.split(<span class="st">','</span>)[<span class="dv">1</span>]</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">except</span>:</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>                            notice_loc<span class="op">=</span><span class="st">"Na"</span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(volume_num)</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(volume_date)</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(volume_url)</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_num_title)</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_act_title)</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_num_year)</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_sub_title)</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_body)</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_date)</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_registrar_name)</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_num_loc)</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>                        entry_deet_full_list.append(notice_loc)</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             #     print(new_deet_list)</span></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>                        first_rep <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(dict_titles,entry_deet_full_list))</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         #         print(first_rep)</span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         #         print("######")</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>                        all_new_notice_entries.append(first_rep)</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> all_new_notice_entries</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> class_to_dictionary(list_all_divs)</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a><span class="co">#         raise e</span></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<section id="how-i-scraped-each-gazette-notice" class="level1">
  
<h1>How I scraped each gazette notice:</h1>
<ul>
<li>Use the function created to now scrape through all gazette links which were earlier scraped and saved into the df_links gazette links. Save it into a large list and then create a dataframe from it</li>
<li>Now merge the data in df_links to the new dataframe df</li>
</ul>
<div class="cell" data-execution_count="12">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_list <span class="op">=</span> []</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> gazette_link <span class="kw">in</span> df_links.gazette_links:</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(gazette_link)</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        my_url <span class="op">=</span> gazette_link</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Get the list of dictionaries</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> scrape_url(my_url)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(len(data))</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data:</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>            data_list.append(data)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># save the resulting large dataframe to csv</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>data_list_flat <span class="op">=</span> [item <span class="cf">for</span> sublist <span class="kw">in</span> data_list <span class="cf">for</span> item <span class="kw">in</span> sublist]</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.DataFrame(data_list_flat)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(99196, 12)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
</section>

<section id="how-i-incorporated-district-data" class="level1">
<h1>How I incorporated district data</h1>
<ul>
<li>Read data on Districts, Population and Area and merge it to the location information in the dataframe</li>
<li>This data is important so that I can normalise the data on population but also so that I can get the code that I can use to group the data by provinces</li>
<li>Clean up the districtsâ€™ names in the dataframe to make it possible to join with districts dataframe</li>
<li>Merge to the main dataframe to include the districtsâ€™ information</li>
</ul>

</section>





  <section id="how-i-regexed" class="level1">
    <h1>How I used regex and other relevant scraping techniques to extract more information from the notices for categories</h1>
    <section id="this-is-what-the-one-section-of-land-related-notices-in-the-weekly-kenya-gazette-looks-like" class="level2">
      <h2 class="anchored" data-anchor-id="this-is-what-the-one-section-of-land-related-notices-in-the-weekly-kenya-gazette-looks-like">This is what the one section of land-related notices in the Weekly Kenya Gazette looks like</h2>
      <div class="quarto-figure quarto-figure-center">
      <figure class="figure">
        
      <p><img src="one_section_of_land_notices_in_weekly_gazette.png" class="img-fluid figure-img"></p>
      <figcaption class="figure-caption">One section of land-related notices</figcaption>
      </figure>
      </div>
      </section>
      <section id="here-are-some-of-the-columns-created" class="level3">
        <h3 class="anchored" data-anchor-id="here-are-some-of-the-columns-created">Here are some of the columns created:</h3>
        <ul>
        <li>First person named in a title: first_named</li>
        <li>Area of land referenced: acres_hectares</li>
        <li>Title deed number: title_number</li>
        <li>ID number of first person named: first_ID</li>
        <li>Address details of first person named: first_address</li>
        <li>LR number: lr_num</li>
        <li>Municipality referenced: municipality</li>
        <li>Second person named in a title: second_person</li>
        <li>IR number: ir_num</li>
        <li>Number of days to expiration: days</li>
        <li>Succession cause number: succession</li>
        <li>township: township</li>
        <li>district: in_the_district_of</li>
        <li>province code: province_code</li>
        </ul>
        </section>
    
    </section>
<section id="here-is-an-example-of-the-use-of-regex-to-extract-number-of-days-notice-administered" class="level3">
<h3 class="anchored" data-anchor-id="here-is-an-example-of-the-use-of-regex-to-extract-number-of-days-notice-administered">Here is an example of the use of regex to extract number of daysâ€™ notice administered</h3>
<div class="cell" data-execution_count="38">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_large_districts[<span class="st">'days'</span>]<span class="op">=</span>df_large_districts.notice_body.<span class="bu">str</span>.extract(<span class="st">"of [\w]+ [(]([\d]+)[)] days"</span>) </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df_large_districts[<span class="st">'days'</span>].sample(<span class="dv">3</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">#of sixty (60) days</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>45623    60
3980     60
59339    60
Name: days, dtype: object</code></pre>
</div>
</div>

<section id="how-i-merged-the-resulting-data-to-data-on-provinces" class="level1">
<h1>How I merged the resulting data to data on provinces</h1>
<p>I wanted to have the option to group the data by provinces <br> I made a dataset that matched every province code in the dataset to a province in Kenya <br> I merged the resulting data to the main dataframe</p>
</section>

<section id="merging-province-data-to-dataframe" class="level1">
<div class="cell" data-execution_count="47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df_large_provinces <span class="op">=</span> pd.merge(df_large_districts, df_provinces, left_on<span class="op">=</span><span class="st">'province_code'</span>, right_on<span class="op">=</span><span class="st">'province_code'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df_large_provinces.sample(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key_0</th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">url_year</th>
<th data-quarto-table-cell-role="th">gazette_links</th>
<th data-quarto-table-cell-role="th">volume_num</th>
<th data-quarto-table-cell-role="th">volume_date</th>
<th data-quarto-table-cell-role="th">volume_url</th>
<th data-quarto-table-cell-role="th">notice_num_title</th>
<th data-quarto-table-cell-role="th">notice_act_title</th>
<th data-quarto-table-cell-role="th">notice_num_year</th>
<th data-quarto-table-cell-role="th">notice_sub_title</th>
<th data-quarto-table-cell-role="th">notice_body</th>
<th data-quarto-table-cell-role="th">notice_date</th>
<th data-quarto-table-cell-role="th">notice_registrar_name</th>
<th data-quarto-table-cell-role="th">notice_num_loc</th>
<th data-quarto-table-cell-role="th">notice_loc</th>
<th data-quarto-table-cell-role="th">District</th>
<th data-quarto-table-cell-role="th">HASC</th>
<th data-quarto-table-cell-role="th">Cod</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Area(km.Â²)</th>
<th data-quarto-table-cell-role="th">Capital</th>
<th data-quarto-table-cell-role="th">district_named</th>
<th data-quarto-table-cell-role="th">first_named</th>
<th data-quarto-table-cell-role="th">acres_hectares</th>
<th data-quarto-table-cell-role="th">title_number</th>
<th data-quarto-table-cell-role="th">first_ID</th>
<th data-quarto-table-cell-role="th">first_address</th>
<th data-quarto-table-cell-role="th">lr_num</th>
<th data-quarto-table-cell-role="th">municipality</th>
<th data-quarto-table-cell-role="th">second_person</th>
<th data-quarto-table-cell-role="th">ir_num</th>
<th data-quarto-table-cell-role="th">days</th>
<th data-quarto-table-cell-role="th">succession</th>
<th data-quarto-table-cell-role="th">township</th>
<th data-quarto-table-cell-role="th">in_the_district_of</th>
<th data-quarto-table-cell-role="th">province_code</th>
<th data-quarto-table-cell-role="th">province</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">78019</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTE5Nw--/Vol.CXVII-No.84/</td>
<td>5</td>
<td>2015</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/year/2015</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTE5Nw--/Vol.CXVII-No.84/</td>
<td>Vol.CXVII-No.84</td>
<td>NAIROBI, \n\t\t \t14 August,2015</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTE5Nw--/Vol.CXVII-No.84/</td>
<td>GAZETTE NOTICE NO. 5877</td>
<td>THE LAND REGISTRATION ACT</td>
<td>(No. 3 of 2012)</td>
<td>ISSUE OF A NEW LAND TITLE DEED</td>
<td>WHEREAS Njuguna Kinuthia Kihiu (ID/1192434), of P.O. Box 67, Sabasaba in the Republic of Kenya, is registered as proprietor in absolute ownership interest of that piece of land containing 5.3 acres or thereabout, situate in the district of Murangâ€™a, registered under title No. Loc. 6/Kiugu/78, and whereas sufficient evidence has been adduced to show that the land title deed issued thereof has been lost, notice is given that after the expiration of sixty (60) days from the date hereof, I shall issue a new title deed provided that no objection has been received within that period.</td>
<td>Dated the 14th August, 2015.</td>
<td>J. K. KAMAU,</td>
<td>MR/7769743 Land Registrar, Murangâ€™a District.</td>
<td>Murangâ€™a</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Njuguna Kinuthia Kihiu</td>
<td>5.3 acres</td>
<td>Loc. 6/Kiugu/78</td>
<td>1192434</td>
<td>P.O. Box 67, Sabasaba</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>60</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Nairobi</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88006</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTE5Mw--/Vol.CXVII-No.80/</td>
<td>5</td>
<td>2015</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/year/2015</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTE5Mw--/Vol.CXVII-No.80/</td>
<td>Vol.CXVII-No.80</td>
<td>NAIROBI, \n\t\t \t31 July,2015</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTE5Mw--/Vol.CXVII-No.80/</td>
<td>GAZETTE NOTICE NO. 5583</td>
<td>THE LAND REGISTRATION ACT</td>
<td>(No. 3 of 2012)</td>
<td>ISSUE OF A NEW LAND TITLE DEED</td>
<td>WHEREAS Naomi Njeri Muhia (ID/5155754), of P.O. Box 175, Gatura in the Republic of Kenya, is registered as proprietor in absolute ownership interest of that piece of land containing 0.04 hectare or thereabouts, situate in the district of Thika, registered under title No. Loc. 16/Mwagu/614, and whereas sufficient evidence has been adduced to show that the land title deed issued thereof has been lost, notice is given that after the expiration of sixty (60) days from the date hereof, I shall issue a new title deed provided that no objection has been received within that period.</td>
<td>Dated the 31st July, 2015.</td>
<td>P. K. KIMANI,</td>
<td>MR/7769850 Land Registrar, Thika District.</td>
<td>Thika</td>
<td>Thika</td>
<td>KE.CE.TH</td>
<td>206.0</td>
<td>645713.0</td>
<td>1960.0</td>
<td>Thika</td>
<td>Thika District</td>
<td>Naomi Njeri Muhia</td>
<td>NaN</td>
<td>Loc. 16/Mwagu/614</td>
<td>5155754</td>
<td>P.O. Box 175, Gatura</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>60</td>
<td>NaN</td>
<td>NaN</td>
<td>Thika</td>
<td>CE</td>
<td>Central</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27828</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTA5NQ--/Vol.CXVI-No.135/</td>
<td>4</td>
<td>2014</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/year/2014</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTA5NQ--/Vol.CXVI-No.135/</td>
<td>Vol.CXVI-No.135</td>
<td>NAIROBI, \n\t\t \t14 November,2014</td>
<td>http://kenyalaw.org/kenya_gazette/gazette/volume/MTA5NQ--/Vol.CXVI-No.135/</td>
<td>GAZETTE NOTICE NO. 8220</td>
<td>THE LAND REGISTRATION ACT</td>
<td>(No. 3 of 2012)</td>
<td>ISSUE OF A NEW LAND TITLE DEED</td>
<td>WHEREAS Cleophas Olukune Assanga, is registered as proprietor in absolute ownership interest of all that piece of land containing 0.05 hectare or thereabouts, situate in the district of Bungoma, registered under title No. Ndivisi/Muchi/5267, and whereas sufficient evidence has been adduced to show that the land title deed issued thereof has been lost, notice is given that after the expiration of sixty (60) days from the date hereof, I shall issue a new title deed provided that no objection has been received within that period.</td>
<td>Dated the 14th November, 2014.</td>
<td>P. K. SIBUCHI,</td>
<td>MR/5951881 Land Registrar, Bungoma/Mt. Elgon Districts.</td>
<td>Na</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Cleophas Olukune Assanga</td>
<td>NaN</td>
<td>Ndivisi/Muchi/5267</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>60</td>
<td>NaN</td>
<td>NaN</td>
<td>Bungoma</td>
<td>NaN</td>
<td>Nairobi</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="46">

</section>
<section id="how-i-mapped-the-dataset" class="level1">
<h1>How I mapped the dataset</h1>
<p>Having grouped the dataset by provinces, I made a chloropleth map showing the distribution of land-related gazette notice activity by province by joining the dataset to a shapefile of Kenyaâ€™s provinces <img src="land_gazette_map.png" class="img-fluid" alt="Landing Page for 2022"></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>
